# Send Message

**In this section you will learn how a user can send message on the forum application.**

When the user sends a message, the message is checked by the `CheckTx` function. The `CheckTx` function checks if the message is correctly formatted or not. It also checks if the user is banned or not.

Following is the blurb of code for the `CheckTx` function:

```go
func (app ForumApp) CheckTx(ctx context.Context, checktx *abci.RequestCheckTx) (*abci.ResponseCheckTx, error) {
    // Parse the tx message
    msg, err := model.ParseMessage(checktx.Tx)
    if err != nil {
        fmt.Printf("failed to parse transaction message checktx: %v\n", err)
        return &abci.ResponseCheckTx{Code: CodeTypeInvalidTxFormat, Log: "Invalid transaction format"}, nil
    }
    
    fmt.Println("Searching for sender ... ", msg.Sender)
    u, err := app.state.DB.FindUserByName(msg.Sender)

    if err != nil {
        if !errors.Is(err, badger.ErrKeyNotFound) {
            fmt.Println("problem in check tx: ", string(checktx.Tx))
            return &abci.ResponseCheckTx{Code: CodeTypeEncodingError}, nil
        }
        fmt.Println("Not found user :", msg.Sender)
    } else {
        if u != nil && u.Banned {
            return &abci.ResponseCheckTx{Code: CodeTypeBanned, Log: "User is banned"}, nil
        }
    }

    fmt.Println("Check tx success for ", msg.Message, " and ", msg.Sender)
    return &abci.ResponseCheckTx{Code: CodeTypeOK}, nil
}
```

Explanation of code:

`CheckTx` function parses the transaction message contained in `checktx.Tx` using the model.ParseMessage function. If there is an error parsing the message, it prints an error message and returns a response with an error code indicating an invalid transaction format.

Then it, searches for a user in the database using the `app.state.DB.FindUserByName` function. If the user is not found, it prints a message indicating that the user was not found. If there is an error other than a key not found error, it prints an error message and returns a response with an error code indicating an encoding error.

If the user is found and is not banned, it returns a response with a success code.

Finally, it prints a success message indicating the success of the check transaction.

*Tip: The function `CheckTx` is a stateless function that is primarily used by the application to check if the tx is being correctly formatted or not.*

Note: You will learn about different packages and functions like `app.state.DB.FindUserByName` in the upcoming sections. In this section you will learn about `app.go` file only.
